---
import Baselayout from "./baselayout.astro";
import "../styles/global.css";

import { getUserStatus } from "../lib/user";
import { $Enums } from "@prisma/client";
/** Main menu items */
let textLinks: { label: string; href: string }[] = [
    { label: "My Page", href: "/app" },
    { label: "Account", href: "/account" },
];

/** ログイン済みの場合，ログアウトリンクを追加する */
if (Astro.locals.user?.id) {
    const us = await getUserStatus(Astro.locals.user.email);
    if (us !== null && us!.role === $Enums.Role.Admin) {
        textLinks.push({ label: "Admin", href: "/admin" });
    }
}

interface Props {
    title: string;
}

const { title } = Astro.props;
---

<Baselayout
    pagename={title}
    homelink="/app"
    title="きろくアプリ"
    textLinks={textLinks}
>
    <slot />
</Baselayout>
